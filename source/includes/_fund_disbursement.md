# Fund Disbursement

Disbursement APIs allow you to instruct OY to disburse fund to any bank accounts in Indonesia easily and real-time.

## Disbursement

```shell
curl -X \
POST https://partner.oyindonesia.com/api/remit \
-H 'content-type: application/json' \
-H 'accept: application/json' \
-H 'x-oy-username:myuser' \
-H 'x-api-key:987654' \
-d '{
  "recipient_bank": "014", 
  "recipient_account": "1239812390", 
  "amount":125000, 
  "note":"Split lunch bill", 
  "partner_trx_id":"1234-asdf",
  "email" :"napoleon@email.com test@email.com"
}'
```

> The above command returns JSON structured similar like this:

```json
{
  "status":{
    "code":"101",
    "message":"Request is Processed"
  },
  "amount":125000,
  "recipient_bank":"014",
  "recipient_account":"1239812390",
  "trx_id":"ABC-456",
  "partner_trx_id":"1234-asdf",
  "timestamp":"16-10-2019 10:23:42"
}
```

Use this API to start disbursing money to a specific beneficiary account.

### HTTPS Request
**[Production]** `POST https://partner.oyindonesia.com/api/remit`<br>
**[Staging]** `POST https://api-stg.oyindonesia.com/api/remit`

### Request Parameters

Parameter | Type | Required | Description
--------- | ---- | -------- | -----------
recipient_bank | String(3) | TRUE | Bank Code of the Beneficiary account, see [Disbursement Bank Codes](#disbursement-bank-codes)
recipient_account | String(255) | TRUE | Beneficiary account number, numeric only
amount | BigInteger | TRUE | Amount of disbursement (Accept Non-Decimal Number), min amount 10000
note | String(255) | FALSE | Add Note to the payout
partner_trx_id | String(255) | TRUE | Unique Payout ID for a specific request, generated by partner
email | String(255) | FALSE | Email for invoice notification (Optional). Email can be more than one but not more that five separated by a whitespace.
### Response Parameters

Parameter | Type | Description
--------- | ---- | -----------
status | Object | Status of Payout in Object `{code: <status_code>, message: <status_message>}`
amount | BigInteger | Amount of disbursement (Accept Non-Decimal Number)
recipient_bank | String(3) | Bank Code of the Beneficiary account, see [Disbursement Bank Codes](#disbursement-bank-codes)
recipient_account | String(255) | Beneficiary account number 
trx_id | String(36) | Unique Payout ID from OY!. Partner can use this ID for settlement
partner_trx_id | String(255) | Unique Payout ID which partner put on the Request
timestamp | String(19) | Execution time of Disbursement in OY! system ("dd-MM-yyyy HH:mm:ss")

## Partner Callback

> Response callback:

```json
{
  "status":{
    "code":"000",
    "message":"Success"
  },
  "amount":125000,
  "recipient_name":"John Doe",
  "recipient_bank":"008",
  "recipient_account":"1234567890",
  "trx_id":"ABC-456",
  "partner_trx_id":"1234-asde",
  "timestamp":"16-10-2020 10:34:23",
  "created_date": "24-01-2020 06:48:08",
  "last_updated_date": "24-01-2020 06:48:39"
}
```

Once a disbursement request is finished, our system will make a callback status of that disbursement request to your system

Please contact us and submit a callback URL if you need a callback status of a disbursement request.

### Callback Parameters

Parameter | Type | Description
--------- | ---- | -----------
status | Object | Status of Payout in Object `{code: <status_code>, message: <status_message>}`
amount | BigInteger | Amount of disbursement (Accept Non-Decimal Number)
recipient_name | String(255) | Account holder name of Beneficiary account number
recipient_bank | String(3) | Bank Code of the Beneficiary account, see [Disbursement Bank Codes](#disbursement-bank-codes)
recipient_account | String(255) | Beneficiary account number
trx_id | String(36) | Unique Payout ID from OY!. Partner can use this ID for settlement
partner_trx_id | String(255) | Unique Payout ID which partner put on the Request, generated by partner
timestamp | String(19) | Execution time of API remit status in OY! system ("dd-MM-yyyy HH:mm:ss")
created_date | String(19) | Executionn time of Disbures in OY! system ("dd-MM-yyyy HH:mm:ss")
last_updated_date | String(19) | Latest status change of a disbursement. Example from 'Pending' to 'Success' ("dd-MM-yyyy HH:mm:ss")

## Get Disbursement Status

```shell
curl -X \
POST https://partner.oyindonesia.com/api/remit-status \
-H 'content-type: application/json' \
-H 'accept: application/json' \
-H 'x-oy-username:myuser' \
-H 'x-api-key:987654' \
-d '{
  "partner_trx_id": "1234-asde", 
  "send_callback": "true"
}'
```

> The above command returns JSON structured similar like this:

```json
{
  "status":{
    "code":"000",
    "message":"Success"
  },
  "amount":125000,
  "recipient_name":"John Doe",
  "recipient_bank":"008",
  "recipient_account":"1234567890",
  "trx_id":"ABC-456",
  "partner_trx_id":"1234-asde",
  "timestamp":"16-10-2020 10:34:23",
  "created_date": "24-01-2020 06:48:08",
  "last_updated_date": "24-01-2020 06:48:39"
}
```

To get status of a disbursement request, you can call this API. You may need to call this API few times until getting a final status (success / failed)

This API offers an option to send you a callback status of the disbursement request to a specific URL.
Please contact us and submit a callback URL if you need a callback status of a disbursement request.

### HTTPS Request
**[Production]** `POST https://partner.oyindonesia.com/api/remit-status`<br>
**[Staging]** `POST https://api-stg.oyindonesia.com/api/remit-status`

### Request Parameters

Parameter | Type | Required | Description
--------- | ---- | -------- | -----------
partner_trx_id | String(255) | TRUE | Unique Payout ID for a specific request, generated by partner
send_callback | Boolean | FALSE | A flag to indiciate if the status of the disbursement request need to be re-sent as a callback or not

### Response Parameters

Parameter | Type | Description
--------- | ---- | -----------
status | Object | Status of Payout in Object `{code: <status_code>, message: <status_message>}`
amount | BigInteger | Amount of disbursement (Accept Non-Decimal Number)
recipient_name | String(255) | Account holder name of Beneficiary account number
recipient_bank | String(3) | Bank Code of the Beneficiary account, see [Disbursement Bank Codes](#disbursement-bank-codes)
recipient_account | String(255) | Beneficiary account number
trx_id | String(36) | Unique Payout ID from OY!. Partner can use this ID for settlement
partner_trx_id | String(255) | Unique Payout ID which partner put on the Request, generated by partner
timestamp | String(19) | Execution time of API remit status in OY! system ("dd-MM-yyyy HH:mm:ss")
created_date | String(19) | Executionn time of Disbures in OY! system ("dd-MM-yyyy HH:mm:ss")
last_updated_date | String(19) | Latest status change of a disbursement. Example from 'Pending' to 'Success' ("dd-MM-yyyy HH:mm:ss")

## Get Balance

```shell
curl -X \
GET https://partner.oyindonesia.com/api/balance \
-H 'Content-Type: application/json' \
-H 'Accept: application/json' \
-H 'X-OY-Username: janedoe' \
-H 'X-Api-Key: 7654321'
```

> The above command returns JSON structured similar like this:

```json
{
  "status":{
    "code":"000",
    "message":"Success"
  },
  "balance":100000000.0000,
  "overdraftBalance":500000.0000,
  "overbookingBalance":200000.0000,
  "pendingBalance":2000000.0000,
  "availableBalance":98500000.0000,
  "timestamp":"10-12-2019 12:15:37"
}
```

Use this API to get partner balance.

### HTTPS Request
**[Production]** `GET https://partner.oyindonesia.com/api/balance`<br>
**[Staging]** `GET https://api-stg.oyindonesia.com/api/balance`

### Response Parameters

Parameter | Type | Description
--------- | ---- | -----------
status | Object | Status of Payout in Object `{code: <status_code>, message: <status_message>}`
balance | BigInteger | Remaining balance (Accept Non-Decimal Number)
overdraftBalance | BigInteger | Remaining overdraft balance (Accept Non-Decimal Number)
overbookingBalance | BigInteger | Remaining overbooking balance (Accept Non-Decimal Number)
pendingBalance | BigInteger | The cumulative balance of your pending transactions.
availableBalance | BigInteger | The total cumulative money of Balance + Available Overdraft - Pending Balance that you can use for disbursement.
timestamp | String(19) | Execution time of Disbursement in OY! system ("dd-MM-yyyy HH:mm:ss").

## Scheduled Disbursement

This set of APIs will allow you to schedule disbursement to any bank account on a specified date.

### Create Scheduled Disbursement
```shell
curl -X \
POST https://partner.oyindonesia.com/api/scheduled-remit \
-H 'content-type: application/json' \
-H 'accept: application/json' \
-H 'x-oy-username:myuser' \
-H 'x-api-key:987654' \
-d '{
  "recipient_bank": "014", 
  "recipient_account": "1239812390",
  "amount": 50000,
  "note": "Split Lunch Bill",
  "partner_trx_id": "123-asdf",
  "email": "napolean@gmail.com test@email.com",
  "schedule_date": "19-11-2020"
}'
```

> The above command returns JSON structured similar like this:

```json
{
  "status": {
      "code": "103",
      "message": "Request is Scheduled"
  },
  "recipient_bank": "014",
  "recipient_account": "1239812390",
  "amount": 10000,
  "scheduled_trx_id": "ABC-456",
  "partner_trx_id": "123-asdf",
  "scheduled_trx_status": "SCHEDULED",
  "schedule_date": "19-11-2020",
  "is_trigger_based": false,
  "trigger_date": null,
  "trigger_email": null,
  "timestamp": "16-11-2020 03:21:15"
}
```

### HTTPS Request
**[Production]** `POST https://partner.oyindonesia.com/api/scheduled-remit`<br>
**[Staging]** `POST https://api-stg.oyindonesia.com/api/scheduled-remit`

There are two types of scheduled disbursement:

1. Non-trigger-based scheduled disbursement: OY! scheduler will run and execute the disbursement automatically on date specified in `schedule_date` field.
2. Trigger-based scheduled disbursement: We will send a fund acceptance email to beneficiary email provided in `trigger_email` field. Beneficiary will be able to execute disbursement by clicking URL provided in the email on or after the date specified in `trigger_date` field.

### Request Parameters

Parameter | Type | Required | Description
--------- | ---- | -------- | -----------
recipient_bank | String(3) | TRUE | Bank Code of the Beneficiary account, see [Disbursement Bank Codes](#disbursement-bank-codes)
recipient_account | String(255) | TRUE | Beneficiary account number, numeric only
amount | BigInteger | TRUE | Amount of disbursement (Accept Non-Decimal Number), min amount 10000
note | String(255) | FALSE | Add Note to the payout
partner_trx_id | String(255) | TRUE | Unique Payout ID for a specific request, generated by partner
email | String(255) | FALSE | Email for invoice notification (Optional). Email can be more than one but not more than five separated by a whitespace
schedule_date | String(10) | FALSE | Date for scheduled non-trigger-based disburse in "dd-mm-yyyy" format. Required if If `is_trigger_based` = FALSE or not set. Date is based on GMT+7
is_trigger_based | Boolean | FALSE | Whether scheduled transfer is trigger-based. Default value is false, if set to true, `trigger_date` and `trigger_email` are required
trigger_date | String(10) | FALSE | Date when the disburse can be claimed by Beneficiary in "dd-mm-yyyy" format. Required if `is_trigger_based` = TRUE. Date is based on GMT+7
trigger_email | String(255) | FALSE | Email which the fund acceptance email and URL will be sent to. Required if is_trigger_based = TRUE. Only one email can be provided
cs_phone_number | String(255) | FALSE | Customer service phone number Beneficiary can contact when a trigger-based disbursement fails. This information will be shown to Beneficiary when trying to claim disbursement on a trigger-based disbursement and disburse execution fails due to insufficient balance. Required if `is_trigger_based` = TRUE
cs_email | String(255) | FALSE | Customer service email Beneficiary can contact when a trigger-based disbursement fails. This information will be shown to Beneficiary when trying to claim disbursement on a trigger-based disbursement and disburse execution fails due to insufficient balance. Required if `is_trigger_based` = TRUE

### Response Parameters

Parameter | Type | Description
--------- | ---- | -----------
status | Object | Status of Scheduled Disburse creation in Object `{code: <status_code>, message: <status_message>}`
recipient_bank | String(3) | Bank Code of the Beneficiary account, see [Disbursement Bank Codes](#disbursement-bank-codes)
recipient_account | String(255) | Beneficiary account number 
amount | BigInteger | Amount of disbursement (Accept Non-Decimal Number)
partner_trx_id | String(255) | Unique Payout ID which partner put on the Request
scheduled_trx_status | String(255) | Status of scheduled disbursement
schedule_date | String(10) | Date for scheduled non-trigger-based disburse in "dd-mm-yyyy" format. Null if scheduled disbursement is trigger-based
is_trigger_based | Boolean | Whether scheduled transfer is trigger-based
trigger_date | String(10) | Date when the disburse can be claimed by Beneficiary in "dd-mm-yyyy" format. Null if scheduled disbursement is non-trigger-based
trigger_email | String(255) | EEmail which the fund acceptance email and URL will be sent to. Null if scheduled disbursement is non-trigger-based
timestamp | String(19) | Time of scheduled disbursement creation in OY! system ("dd-MM-yyyy HH:mm:ss")

### Get Detail of Scheduled Disbursement
This endpoint allows you to get detail of a created scheduled disbursement.

```shell
curl -X \
GET https://partner.oyindonesia.com/api/scheduled-remit \
-H 'content-type: application/json' \
-H 'accept: application/json' \
-H 'x-oy-username:myuser' \
-H 'x-api-key:987654' \
-d '{
  "partner_trx_id": "123-asdf"
}'
```

> The above command returns JSON structured similar like this:

```json
{
  "status": {
      "code": "000",
      "message": "Success"
  },
  "recipient_bank": "014",
  "recipient_account": "1239812390",
  "amount": 10000,
  "scheduled_trx_id": "ABC-456",
  "partner_trx_id": "123-asdf",
  "scheduled_trx_status": "SUCCESS",
  "schedule_date": "19-11-2020",
  "is_trigger_based": false,
  "trigger_date": null,
  "trigger_email": null,
  "timestamp": "16-11-2020 03:21:15"
}
```

### HTTPS Request
**[Production]** `GET https://partner.oyindonesia.com/api/scheduled-remit`<br>
**[Staging]** `GET https://api-stg.oyindonesia.com/api/scheduled-remit`

### Request Parameters

Parameter | Type | Required | Description
--------- | ---- | -------- | -----------
partner_trx_id | String(255) | TRUE | Unique Payout ID which partner put on scheduled disburse creation

### Response Parameters

Parameter | Type | Description
--------- | ---- | -----------
status | Object | Status of get detail Scheduled Disburse in Object `{code: <status_code>, message: <status_message>}`
recipient_bank | String(3) | Bank Code of the Beneficiary account, see [Disbursement Bank Codes](#disbursement-bank-codes)
recipient_account | String(255) | Beneficiary account number 
amount | BigInteger | Amount of disbursement (Accept Non-Decimal Number)
partner_trx_id | String(255) | Unique Payout ID which partner put on the Request
scheduled_trx_status | String(255) | Status of scheduled disbursement
schedule_date | String(10) | Date for scheduled non-trigger-based disburse in "dd-mm-yyyy" format. Null if scheduled disbursement is trigger-based
is_trigger_based | Boolean | Whether scheduled transfer is trigger-based
trigger_date | String(10) | Date when the disburse can be claimed by Beneficiary in "dd-mm-yyyy" format. Null if scheduled disbursement is non-trigger-based
trigger_email | String(255) | EEmail which the fund acceptance email and URL will be sent to. Null if scheduled disbursement is non-trigger-based
timestamp | String(19) | Time of scheduled disbursement creation in OY! system ("dd-MM-yyyy HH:mm:ss")

### Get List of Scheduled Disbursement
This endpoint allows you get list of scheduled disbursement with or without applying filter on status and processing date (`trigger_date`/`schedule_date`)

```shell
curl -X \
GET https://partner.oyindonesia.com/api/scheduled-remit/list \
-H 'content-type: application/json' \
-H 'accept: application/json' \
-H 'x-oy-username:myuser' \
-H 'x-api-key:987654' \
-d '{
  "scheduled_trx_status": "SCHEDULED",
  "start_date": "20-11-2020",
  "end_date": "20-11-2020",
  "offset": 0,
  "limit": 100
}'
```

> The above command returns JSON structured similar like this:

```json
{
    "status": {
        "code": "000",
        "message": "Success"
    },
    "start_date": "20-11-2020",
    "end_date": "20-11-2020",
    "scheduled_trx_status": "SCHEDULED",
    "total_scheduled_disburse": 2,
    "total_amount": 25000.0000,
    "offset": 0,
    "limit": 100,
    "data": [
        {
            "recipient_bank": "014",
            "recipient_account": "111",
            "amount": 10000.0000,
            "scheduled_trx_id": "scheduled-trx-123",
            "partner_trx_id": "partner-trx-123",
            "scheduled_trx_status": "SCHEDULED",
            "schedule_date": null,
            "is_trigger_based": true,
            "trigger_date": "20-11-2020",
            "trigger_email": "ivana.thomas@oyindonesia.com"
        },
        {
            "recipient_bank": "014",
            "recipient_account": "111",
            "amount": 15000.0000,
            "scheduled_trx_id": "scheduled-trx-456",
            "partner_trx_id": "partner-trx-456",
            "scheduled_trx_status": "SUCCESS",
            "schedule_date": "20-11-2020",
            "is_trigger_based": false,
            "trigger_date": null,
            "trigger_email": "ivana.thomas@oyindonesia.com"
        }
    ],
    "timestamp": "01-12-2020 11:42:12"
}
```

### HTTPS Request
**[Production]** `POST https://partner.oyindonesia.com/api/scheduled-remit/list`<br>
**[Staging]** `POST https://api-stg.oyindonesia.com/api/scheduled-remit/list`

### Request Parameters

Parameter | Type | Required | Description
--------- | ---- | -------- | -----------
start_date | String(10) | FALSE | Start date filter in "dd-mm-yyyy" format. List of scheduled disburse retrieved will be filtered and have `trigger_date`/`schedule_date` >= date defined in this parameter.
start_date | String(10) | FALSE | End date filter in "dd-mm-yyyy" format. List of scheduled disburse retrieved will be filtered and have `trigger_date`/`schedule_date` <= date defined in this parameter.
scheduled_trx_status | String(255) | FALSE | Status filter. List of scheduled disburse retrieved will be filtered with status defined with this parameter. Status for scheduled disbursement: `SCHEDULED`, `PENDING`, `SUCCESS`, `BALANCE_IS_NOT_ENOUGH`, `FAILED`
offset | Integer | FALSE | Offset for retrieved list of scheduled disburse. Default is 0
limit | Integer | FALSE | Limit for retrieved list of scheduled disburse. Default and maximum is 100

### Response Parameters

Parameter | Type | Description
--------- | ---- | -----------
status | Object | Status of get list Scheduled Disburse in Object `{code: <status_code>, message: <status_message>}`
total_amount | BigInteger | Sum of amount of all scheduled disburse with given filter regardless of offset and limit
total_scheduled_disburse | BigInteger | Count of total scheduled disburse with given filter regardless of offset and limit
start_date | String(10) | Start date filter in "dd-mm-yyyy" format as given in request. Default is null.
end_date | String(10) | End date filter in "dd-mm-yyyy" format as given in request. Default is null.
scheduled_trx_status | String(10) | Status filter as given in request. Default is null.
offset | Integer | Offset for retrieved list of scheduled disburse as given in request. Default is 0
limit | Integer | Limit for retrieved list of scheduled disburse. Default and maximum is 100
data | List of Object | List of scheduled disburse detail according to given limit and offset. Parameter details of each scheduled disburse in the list is the same as response parameters in [Get Detail Scheduled Disburse](#get-detail-of-scheduled-disbursement)

### Update Scheduled Disbursement
This endpoint allows you to update created scheduled disbursement up to a day before the `schedule_date`/`trigger_date`. For non-trigger based scheduled disburse, only update to `schedule_date` is allowed. For trigger-based scheduled disburse, only update to `trigger_date` is allowed.

```shell
curl -X \
PUT https://partner.oyindonesia.com/api/scheduled-remit \
-H 'content-type: application/json' \
-H 'accept: application/json' \
-H 'x-oy-username:myuser' \
-H 'x-api-key:987654' \
-d '{
  "partner_trx_id": "123-asdf",
  "schedule_date": "21-11-2020"
}'
```

> The above command returns JSON structured similar like this:

```json
{
  "status": {
      "code": "000",
      "message": "Success"
  },
  "recipient_bank": "014",
  "recipient_account": "1239812390",
  "amount": 10000,
  "scheduled_trx_id": "ABC-456",
  "partner_trx_id": "123-asdf",
  "scheduled_trx_status": "SCHEDULED",
  "schedule_date": "21-11-2020",
  "is_trigger_based": false,
  "trigger_date": null,
  "trigger_email": null,
  "timestamp": "16-11-2020 03:21:15"
}
```

### HTTPS Request
**[Production]** `PUT https://partner.oyindonesia.com/api/scheduled-remit`<br>
**[Staging]** `PUT https://api-stg.oyindonesia.com/api/scheduled-remit`

### Request Parameters

Parameter | Type | Required | Description
--------- | ---- | -------- | -----------
partner_trx_id | String(255) | TRUE | Unique Payout ID for a specific request, generated by partner
schedule_date | String(10) | FALSE | Updated date for scheduled non-trigger-based disburse in "dd-mm-yyyy" format. Required if scheduled disbursement is non-trigger-based. Date is based on GMT+7
trigger_date | String(10) | FALSE | Updated date when the disburse can be claimed by Beneficiary in "dd-mm-yyyy" format. Required if scheduled disbursement is trigger-based. Date is based on GMT+7

### Response Parameters

Parameter | Type | Description
--------- | ---- | -----------
status | Object | Status of Scheduled Disburse update in Object `{code: <status_code>, message: <status_message>}`
recipient_bank | String(3) | Bank Code of the Beneficiary account, see [Disbursement Bank Codes](#disbursement-bank-codes)
recipient_account | String(255) | Beneficiary account number 
amount | BigInteger | Amount of disbursement (Accept Non-Decimal Number)
partner_trx_id | String(255) | Unique Payout ID which partner put on the Request
scheduled_trx_status | String(255) | Status of scheduled disbursement
schedule_date | String(10) | Date for scheduled non-trigger-based disburse in "dd-mm-yyyy" format. Null if scheduled disbursement is trigger-based
is_trigger_based | Boolean | Whether scheduled transfer is trigger-based
trigger_date | String(10) | Date when the disburse can be claimed by Beneficiary in "dd-mm-yyyy" format. Null if scheduled disbursement is non-trigger-based
trigger_email | String(255) | Email which the fund acceptance email and URL will be sent to. Null if scheduled disbursement is non-trigger-based
timestamp | String(19) | Time of scheduled disbursement update in OY! system ("dd-MM-yyyy HH:mm:ss")

### Cancel Scheduled Disbursement
This endpoint allows you to cancel created scheduled disbursement up to a day before the `schedule_date`/`trigger_date`.

```shell
curl -X \
DELETE https://partner.oyindonesia.com/api/scheduled-remit \
-H 'content-type: application/json' \
-H 'accept: application/json' \
-H 'x-oy-username:myuser' \
-H 'x-api-key:987654' \
-d '{
  "partner_trx_id": "123-asdf"
}'
```

> The above command returns JSON structured similar like this:

```json
{
  "status": {
      "code": "000",
      "message": "Success"
  },
  "recipient_bank": "014",
  "recipient_account": "1239812390",
  "amount": 10000,
  "scheduled_trx_id": "ABC-456",
  "partner_trx_id": "123-asdf",
  "scheduled_trx_status": "CANCELLED",
  "schedule_date": "21-11-2020",
  "is_trigger_based": false,
  "trigger_date": null,
  "trigger_email": null,
  "timestamp": "16-11-2020 03:21:15"
}
```

### HTTPS Request
**[Production]** `DELETE https://partner.oyindonesia.com/api/scheduled-remit`<br>
**[Staging]** `DELETE https://api-stg.oyindonesia.com/api/scheduled-remit`

### Request Parameters

Parameter | Type | Required | Description
--------- | ---- | -------- | -----------
partner_trx_id | String(255) | TRUE | Unique Payout ID for a specific request, generated by partner

### Response Parameters

Parameter | Type | Description
--------- | ---- | -----------
status | Object | Status of Scheduled Disburse cancellation in Object `{code: <status_code>, message: <status_message>}`
recipient_bank | String(3) | Bank Code of the Beneficiary account, see [Disbursement Bank Codes](#disbursement-bank-codes)
recipient_account | String(255) | Beneficiary account number 
amount | BigInteger | Amount of disbursement (Accept Non-Decimal Number)
partner_trx_id | String(255) | Unique Payout ID which partner put on the Request
scheduled_trx_status | String(255) | Status of scheduled disbursement
schedule_date | String(10) | Date for scheduled non-trigger-based disburse in "dd-mm-yyyy" format. Null if scheduled disbursement is trigger-based
is_trigger_based | Boolean | Whether scheduled transfer is trigger-based
trigger_date | String(10) | Date when the disburse can be claimed by Beneficiary in "dd-mm-yyyy" format. Null if scheduled disbursement is non-trigger-based
trigger_email | String(255) | EEmail which the fund acceptance email and URL will be sent to. Null if scheduled disbursement is non-trigger-based
timestamp | String(19) | Time of scheduled disbursement cancellation in OY! system ("dd-MM-yyyy HH:mm:ss")

### Retry Scheduled Disbursement
This endpoint will allow you to create a new scheduled disbursement based on the detail of a previous failed/cancelled scheduled disbursement.

```shell
curl -X \
POST https://partner.oyindonesia.com/api/scheduled-remit/retry \
-H 'content-type: application/json' \
-H 'accept: application/json' \
-H 'x-oy-username:myuser' \
-H 'x-api-key:987654' \
-d '{
  "old_partner_trx_id": "123-asdf",
  "new_partner_trx_id": "456-asdf",
  "schedule_date": "22-11-2020"
}'
```

> The above command returns JSON structured similar like this:

```json
{
  "status": {
      "code": "000",
      "message": "Success"
  },
  "recipient_bank": "014",
  "recipient_account": "1239812390",
  "amount": 10000,
  "scheduled_trx_id": "DEF-456",
  "partner_trx_id": "456-asdf",
  "scheduled_trx_status": "SCHEDULED",
  "schedule_date": "22-11-2020",
  "is_trigger_based": false,
  "trigger_date": null,
  "trigger_email": null,
  "timestamp": "16-11-2020 03:21:15"
}
```

### HTTPS Request
**[Production]** `POST https://partner.oyindonesia.com/api/scheduled-remit/retry`<br>
**[Staging]** `POST https://api-stg.oyindonesia.com/api/scheduled-remit/retry`

### Request Parameters

Parameter | Type | Required | Description
--------- | ---- | -------- | -----------
old_partner_trx_id | String(255) | TRUE | Partner transaction ID of a failed/cancelled scheduled disbursement which you want to retry
new_partner_trx_id | String(255) | TRUE | New partner transaction ID which will be given to the newly created scheduled disbursement
schedule_date | String(255) | FALSE | Date for the newly created scheduled, non-trigger-based disburse, in "dd-mm-yyyy" format. Required if old scheduled disbursement is non-trigger-based
trigger_date | String(255) | FALSE | Date for the newly created scheduled disburse to be claimed by beneficiary, in "dd-mm-yyyy" format. Required if old scheduled disbursement is trigger-based

### Response Parameters

Parameter | Type | Description
--------- | ---- | -----------
status | Object | Status of new Scheduled Disburse creation in Object `{code: <status_code>, message: <status_message>}`
recipient_bank | String(3) | Bank Code of the Beneficiary account, see [Disbursement Bank Codes](#disbursement-bank-codes)
recipient_account | String(255) | Beneficiary account number 
amount | BigInteger | Amount of disbursement (Accept Non-Decimal Number)
partner_trx_id | String(255) | Unique Payout ID which partner put on the Request
scheduled_trx_status | String(255) | Status of scheduled disbursement
schedule_date | String(10) | Date for scheduled non-trigger-based disburse in "dd-mm-yyyy" format. Null if scheduled disbursement is trigger-based
is_trigger_based | Boolean | Whether scheduled transfer is trigger-based
trigger_date | String(10) | Date when the disburse can be claimed by Beneficiary in "dd-mm-yyyy" format. Null if scheduled disbursement is non-trigger-based
trigger_email | String(255) | EEmail which the fund acceptance email and URL will be sent to. Null if scheduled disbursement is non-trigger-based
timestamp | String(19) | Time of new scheduled disbursement creation in OY! system ("dd-MM-yyyy HH:mm:ss")

### Partner Callback on Scheduled Disburse Execution

> Response callback:

```json
{
  "status":{
    "code":"000",
    "message":"Success"
  },
  "amount":125000,
  "recipient_name":"John Doe",
  "recipient_bank":"008",
  "recipient_account":"1234567890",
  "trx_id": "ABC-123",
  "scheduled-trx-id": "DEF-456",
  "scheduled_trx_status": "SUCCESS",
  "schedule_date": "22-11-2020",
  "is_trigger_based": false,
  "trigger_date": null,
  "trigger_email": null,
  "timestamp":"16-10-2020 10:34:23",
  "created_date": "24-01-2020 06:48:08",
  "last_updated_date": "24-01-2020 06:48:39"
}
```

Once a scheduled disbursement is executed, our system will make a callback status of that disbursement request to your system

Please contact us and submit a callback URL if you need a callback status of a scheduled disbursement request.

### Callback Parameters

Parameter | Type | Description
--------- | ---- | -----------
status | Object | Status of Scheduled Disburse execution in Object `{code: <status_code>, message: <status_message>}`
amount | BigInteger | Amount of disbursement (Accept Non-Decimal Number)
recipient_name | String(255) | Account holder name of Beneficiary account number
recipient_bank | String(3) | Bank Code of the Beneficiary account, see [Disbursement Bank Codes](#disbursement-bank-codes)
recipient_account | String(255) | Beneficiary account number
trx_id | String(36) | Unique Payout ID from OY!. Partner can use this ID for settlement
partner_trx_id | String(255) | Unique Payout ID which partner put on the Request, generated by partner
scheduled_trx_id | String(255) | Unique ID for scheduled disbursement from OY!
schedule_date | String(10) | Date for scheduled non-trigger-based disburse in "dd-mm-yyyy" format. Null if scheduled disbursement is trigger-based
is_trigger_based | Boolean | Whether scheduled transfer is trigger-based
trigger_date | String(10) | Date when the disburse can be claimed by Beneficiary in "dd-mm-yyyy" format. Null if scheduled disbursement is non-trigger-based
timestamp | String(19) | Execution time of scheduled disburse in OY! system ("dd-MM-yyyy HH:mm:ss")
created_date | String(19) | Time when scheduled disburse was first scheduled ("dd-MM-yyyy HH:mm:ss")
last_updated_date | String(19) | Latest status change of a scheduled disbursement. Example from 'Scheduled' to 'Success' ("dd-MM-yyyy HH:mm:ss")

## Mock number Staging API

To get response code status of a disbursement inquiry request, you can use this mock:

 Parameter | Expected Result
--------- | -----------
2222222222 (recipient_account) | BANK_CODE_NOT_FOUND("205", "Bank Code is not found")
8888888888 (recipient_account) | BANK_ACCOUNT_NOT_FOUND("209", "Bank Account is not found")
other value (recipient_account) | SUCCESS("000", "Success")

To get response code status of a disbursement remit request, you can use this mock:

 Parameter | Expected Result
--------- | -----------
1234567890 (recipient_account) | INTERNAL_SERVER_ERROR("999", "Internal Server Error")
1111111111 (recipient_account) | DUPLICATE_PARTNER_TX_ID("203", "Duplicate Partner Tx Id")
2222222222 (recipient_account) | BANK_CODE_NOT_FOUND("205", "Bank Code is not found")
3333333333 (recipient_account) | TX_ID_NOT_FOUND("204", "Tx Id is not found")
4444444444 (recipient_account) | USER_IS_NOT_FOUND("201", "User is not found")
5555555555 (recipient_account) | USER_IS_NOT_ACTIVE("202", "User is not active")
other value (recipient_account) | PROCESSED("101", "Request is Processed")

To get response code status of a disbursement remit status request, you can use this mock:

 Parameter | Expected Result
--------- | -----------
1234567890 (recipient_account) | INTERNAL_SERVER_ERROR("999", "Internal Server Error")
6666666666 (recipient_account) | IN_PROGRESS("102", "Request is In progress")
7777777777 (recipient_account) | FAILED("300", "Failed")
8888888888 (recipient_account) | BANK_ACCOUNT_NOT_FOUND("209", "Bank Account is not found")
9999999999 (recipient_account) | SUSPECT(“301”, “Suspect”)
other value (recipient_account) | SUCCESS("000", "Success")

To get response code status of a disbursement balance request, you can use this mock:



 Parameter | Expected Result
--------- | -----------
\<Partner Username\> (X-OY-Username) | SUCCESS("000", "Success")
other value (X-OY-Username) | USER_IS_NOT_FOUND("201", "User is not found")


